<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <form method="POST">
      <a id="upload_widget" class="cloudinary-button">Upload files</a>
      <input type="hidden" id="uploaded_file_url" name="uploaded_file_url"/>
      <input type="submit" value="Submit Form"/>
    </form>
    <script
      src="https://widget.cloudinary.com/v2.0/global/all.js"
      type="text/javascript"
    ></script>
    <script type="text/javascript">
      var myWidget = cloudinary.createUploadWidget(
        {
          cloudName: "{{CLOUD_NAME}}",
          uploadPreset: "{{CLOUD_UPLOAD_PRESET}}",
        },
        (error, result) => {
          if (!error && result && result.event === "success") {
            console.log("Done! Here is the image info: ", result.info);
            document.querySelector("#uploaded_file_url").value = result.info.url;

          }
        }
      );

      document.getElementById("upload_widget").addEventListener(
        "click",
        function () {
          myWidget.open();
        },
        false
      );
    </script>
  </body>
</html>
